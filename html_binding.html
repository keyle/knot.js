<!DOCTYPE html>
<html>
<head>
	<title>test</title>
	<script type="text/javascript" src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.6.1.min.js"></script>
	<script type="text/javascript" src="knot.js"></script>
</head>
<body>

<!--<table data-collection='posts' border='1'>
	<tr>
		<th>title</th>
		<th>date</th>
		<th>link</th>
	</tr>
	<tr data-collection-item>
		<td data-bind='title'>title default</td>
		<td data-bind='date'>date default</td>
		<td data-bind='link'>link default</td>
	</tr>
</table>-->

<ul data-bind='posts'>
	<li data-repeater>{title}, {date}, {link}</li>
</ul>
blaaaahr
<ul data-bind='posts'>
	<li data-repeater>{title}, {date}, {link}</li>
</ul>

<table data-bind='posts'>
	<tr data-repeater>{title}, {date}, {link}</tr>
</table>

<script type="text/javascript">

	var model =
	{
		posts :
		[
			{ title: 'title 1', date: '22/11/1980', link: 'http://noben.org/' },
			{ title: 'title 2', date: '12/12/1995', link: 'http://idle.org/' },
			{ title: 'title 3', date: '25/03/1999', link: 'http://news.org/' },
			{ title: 'title 4', date: '05/05/2011', link: 'http://pebbles.org/' },
		]
	}

	$(document).ready(function() {

		bindAllCollections();

	});

	function bindAllCollections()
	{
		$(document).find('*[data-bind]').each(bindCollection);
	}

	function bindCollection()
	{
		var collection = model[this.dataset.bind];

		if(!collection) return; // no model object found

		var innerhtml = $(this).html();
		$(this).html('');

		for (var i = 0; i < collection.length; i++)
		{
			var newhtml = innerhtml;

			for(var key in collection[i])
			{
				newhtml = newhtml.replace('{'+key+'}', collection[i][key]);
				//alert('replace {0} by {1}'.f(key, collection[i][key]));
			}

			$(this).append(newhtml);
		}

	}

// format string

String.prototype.format = function() {
    var s = this,
        i = arguments.length;

    while (i--) {
        s = s.replace(new RegExp('\\{' + i + '\\}', 'gm'), arguments[i]);
    }
    return s;
};

String.prototype.f = String.prototype.format;

</script>



* find all tag by attribute data-collection
* for each tag
* find the data-collection object corresponding
* find collection-item object
* template it and remove it
* for each collection item in the model
* add the template with replace {var name}

- alternate rows?
- how to show multiple data fields in the one html field? (converter?)

<button>add</button>

</body>
</html>
